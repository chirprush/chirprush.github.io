<!DOCTYPE html>
<html>
    <head>
        <title>chirprush - Codeforces: Problem 1916H1</title>

        <link rel="stylesheet" href="/assets/css/style.css">
        <link rel="stylesheet" href="/assets/css/panel.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <!-- Katex -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script>
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>

        
        <meta charset="utf-8">
    </head>

    <body>
        <div id="side-nav" class="side-panel">
            <div class="panel-content">
                <div class="panel-grid">
                    <img class="grid-pfp" src="/assets/images/pfp.svg"></img>
                    <h2 class="grid-title">Rushil Surti</h1>
                    <p class="grid-email">rush040507@gmail.com</p>
                    <div class="grid-icons"><a href="https://www.github.com/chirprush/" target="_blank"><i class="fa-brands fa-github"></i></a> <a href="https://www.youtube.com/channel/UCSc-MTo8KGPDMLszD6jYjxA" target="_blank"><i class="fa-brands fa-youtube"></i></a> <a href="https://www.instagram.com/chirprush/" target="_blank"><i class="fa-brands fa-instagram"></i></a> <a href="https://math.stackexchange.com/users/1128617/chirpyboat73" target="_blank"><i class="fa-brands fa-stack-exchange"></i></a></div>
                </div>

                <hr class="separator" />

                <div class="description">
                    <h2>Description</h2>
                    <div class="side-line">
                        <p>A very mathy and beautiful 2700 rated Codeforces problem. This one had me really excited to solve.</p>
                    </div>
                </div>

                <div class="contents">
                    <h2>Contents</h2>
                    <div class="side-line">
                        <ul>
                        <li><a href="#problem">Problem</a></li>
                        <li><a href="#solution">Solution</a></li>
                        </ul>
                        <!--
                        <ul>
                            <li><b>Section 1.</b> Sample text</li>
                            <li><ul>
                                <li><b>Section 1.1.</b> Some stuff</li>
                            </ul></li>
                            <li><b>Section 2.</b> More sample text</li>
                        </ul>
                        -->
                    </div>
                </div>

                <div class="navigation-container">
                    <a href="/index.html">Articles</a>
                    <a href="/tags.html">Tags</a>
                    <a href="/about.html">About Me</a>
                </div>
            </div>
        </div>

        <div class="content-wrapper">
            <div class="content">
                <h1>Codeforces: Problem 1916H1</h1>

                <hr class="separator" />
                <div class="info-holder">
                    <span class="info-value"><b>Author:</b> Rushil Surti</span>
                    <span class="info-value"><b>Date:</b> July 21, 2024</span>
                    <span class="info-value"><b>Tags:</b>  <a href="/tags.html#codeforces"><span class="info-tag">codeforces</span></a>  <a href="/tags.html#linear-algebra"><span class="info-tag">linear-algebra</span></a>  <a href="/tags.html#matrices"><span class="info-tag">matrices</span></a>  <a href="/tags.html#combinatorics"><span class="info-tag">combinatorics</span></a>  <a href="/tags.html#number-theory"><span class="info-tag">number-theory</span></a> </span>
                </div>

                <h2 id="problem">Problem</h2>
                <div class="side-box">
                <p><strong>Problem.</strong> For each <span class="math inline">\(r\)</span> where <span class="math inline">\(0 \le r \le m\)</span>, count the number of <span class="math inline">\(n \times n\)</span> matrices over <span class="math inline">\(\mathbb{F}_p\)</span> with rank <span class="math inline">\(r\)</span> modulo some large fixed prime <span class="math inline">\(P\)</span>.</p>
                </div>
                <h2 id="solution">Solution</h2>
                <p>After quite a bit of thinking and structuring the problem, we arrive at the following realization, which allows us to somewhat easily solve for the quantities we're looking for: for each <span class="math inline">\(0 \le r \le m\)</span>, <span class="math display">\[
                    \sum_{k = 0}^{r} \textsf{sub}[r, k] \cdot \textsf{ranks}[k] = p^{nr}
                ,\]</span> where <span class="math inline">\(\textsf{sub}[r, k]\)</span> denotes the number of dimension <span class="math inline">\(k\)</span> subspaces that a dimension <span class="math inline">\(r\)</span> vector space over <span class="math inline">\(\mathbb{F}_p\)</span> has, and <span class="math inline">\(\textsf{ranks}[k]\)</span> denotes the number of <span class="math inline">\(n \times n\)</span> matrices with rank <span class="math inline">\(k\)</span> formed using vectors from a fixed <span class="math inline">\(k\)</span> dimensional vector space. Our answer for each <span class="math inline">\(r\)</span> is then <span class="math inline">\(\textsf{sub}[n, r] \cdot \textsf{ranks}[r]\)</span>.</p>
                <p>In other words, we have a system of <span class="math inline">\(m + 1\)</span> equations in our <span class="math inline">\(m + 1\)</span> unknowns that we wish to solve for, namely each <span class="math inline">\(\textsf{ranks}[k]\)</span>. Thus, we've reduced the problem down to counting the number of subspaces of a vector space over this finite field.</p>
                <p><strong>Claim</strong>. We have that <span class="math display">\[
                    \textsf{sub}[r, k] = \frac{(p^r - 1)(p^r - p) \cdots (p^r - p^{k - 1})}{(p^k - 1)(p^k - p) \cdots (p^k - p^{k-1})}
                .\]</span></p>
                <p><em>Proof.</em> We would like to be able to pick out <span class="math inline">\(k\)</span>-dimensional subspaces of a <span class="math inline">\(r\)</span>-dimensional vector space, so we do so by picking <span class="math inline">\(k\)</span> linearly independent vectors to form a basis. However, this overcounts by quite a bit, so we must divide by the number of ways to choose <span class="math inline">\(k\)</span> linearly independent vectors from the subspace that we found. <span class="math inline">\(\blacksquare\)</span></p>
                <p>Since the denominator of <span class="math inline">\(\textsf{sub}[r, k]\)</span> can be precomputed in reasonable time and the numerator can be computed with an easy recursion, we can solve for <span class="math inline">\(\textsf{ranks}[k]\)</span> and thus find the answer in something like <span class="math inline">\(O(k^2 \log n)\)</span> time, where the logarithm factor appears because of calculating the exponentials modulo the fixed prime <span class="math inline">\(P\)</span>.</p>
            </div>
        </div>
    </body>
</html>

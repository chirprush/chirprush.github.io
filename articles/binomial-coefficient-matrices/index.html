<!DOCTYPE html>
<html>
    <head>
        <title>chirprush - Binomial Coefficient Matrices</title>

        <link rel="stylesheet" href="/assets/css/style.css">
        <link rel="stylesheet" href="/assets/css/panel.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <!-- Katex -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script>
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>

        
        <meta charset="utf-8">
    </head>

    <body>
        <div id="side-nav" class="side-panel">
            <div class="panel-content">
                <div class="panel-grid">
                    <img class="grid-pfp" src="/assets/images/pfp.svg"></img>
                    <h2 class="grid-title">Rushil Surti</h1>
                    <p class="grid-email">rush040507@gmail.com</p>
                    <div class="grid-icons"><a href="https://www.github.com/chirprush/" target="_blank"><i class="fa-brands fa-github"></i></a> <a href="https://www.youtube.com/channel/UCSc-MTo8KGPDMLszD6jYjxA" target="_blank"><i class="fa-brands fa-youtube"></i></a> <a href="https://www.instagram.com/chirprush/" target="_blank"><i class="fa-brands fa-instagram"></i></a> <a href="https://math.stackexchange.com/users/1128617/chirpyboat73" target="_blank"><i class="fa-brands fa-stack-exchange"></i></a></div>
                </div>

                <hr class="separator" />

                <div class="description">
                    <h2>Description</h2>
                    <div class="side-line">
                        <p><p>Let's explore the properties of lower
triangular matrices filled with binomial coefficients.</p></p>
                    </div>
                </div>

                <div class="contents">
                    <h2>Contents</h2>
                    <div class="side-line">
                        <ul>
                        <li><a href="#main-idea" id="toc-main-idea">Main
                        Idea</a></li>
                        <li><a href="#exploration"
                        id="toc-exploration">Exploration</a>
                        <ul>
                        <li><a href="#evaluating-a-tranpose-product"
                        id="toc-evaluating-a-tranpose-product">Evaluating
                        A Tranpose Product</a></li>
                        <li><a href="#evaluating-the-inverse"
                        id="toc-evaluating-the-inverse">Evaluating The
                        Inverse</a></li>
                        </ul></li>
                        <li><a href="#applications"
                        id="toc-applications">Applications</a></li>
                        </ul>
                        <!--
                        <ul>
                            <li><b>Section 1.</b> Sample text</li>
                            <li><ul>
                                <li><b>Section 1.1.</b> Some stuff</li>
                            </ul></li>
                            <li><b>Section 2.</b> More sample text</li>
                        </ul>
                        -->
                    </div>
                </div>

                <div class="navigation-container">
                    <a href="/index.html">Articles</a>
                    <a href="/tags.html">Tags</a>
                    <a href="/about.html">About Me</a>
                </div>
            </div>
        </div>

        <div class="content-wrapper">
            <div class="content">
                <h1>Binomial Coefficient Matrices</h1>

                <hr class="separator" />
                <div class="info-holder">
                    <span class="info-value"><b>Author:</b> Rushil Surti</span>
                    <span class="info-value"><b>Date:</b> June 30,
2024</span>
                    <span class="info-value"><b>Tags:</b>  <a href="/tags.html#linear-algebra"><span class="info-tag">linear-algebra</span></a>  <a href="/tags.html#matrices"><span class="info-tag">matrices</span></a>  <a href="/tags.html#combinatorics"><span class="info-tag">combinatorics</span></a>  <a href="/tags.html#binomial-coefficient"><span class="info-tag">binomial-coefficient</span></a> </span>
                    <span class="info-value"><b>Edited:</b> October 15,
2025</span>
                </div>

                <h2 id="main-idea">Main Idea</h2>
                <p><strong>Idea.</strong> Consider <span
                class="math inline">\((n + 1) \times (n + 1)\)</span>
                matrices of the form <span class="math inline">\(A_{ij}
                = \binom{i - 1}{j - 1}\)</span>, with the convention
                that <span class="math inline">\(\binom{i}{j} =
                0\)</span> for <span class="math inline">\(j &gt;
                i\)</span>. Denote these matrices by <span
                class="math inline">\(B_n\)</span>. What kind of
                properties do these matrices (and perhaps similar ones)
                have?</p>
                <p><strong>Example.</strong> The first few such matrices
                are <span class="math display">\[
                    B_0 = \begin{bmatrix}
                        1
                    \end{bmatrix},
                    B_1 = \begin{bmatrix}
                        1 &amp; 0 \\
                        1 &amp; 1
                    \end{bmatrix},
                    B_2 = \begin{bmatrix}
                        1 &amp; 0 &amp; 0 \\
                        1 &amp; 1 &amp; 0 \\
                        1 &amp; 2 &amp; 1
                    \end{bmatrix},
                    B_3 = \begin{bmatrix}
                        1 &amp; 0 &amp; 0 &amp; 0 \\
                        1 &amp; 1 &amp; 0 &amp; 0 \\
                        1 &amp; 2 &amp; 1 &amp; 0 \\
                        1 &amp; 3 &amp; 3 &amp; 1
                    \end{bmatrix}
                .\]</span></p>
                <h2 id="exploration">Exploration</h2>
                <p>Immediately we can see that by definition such
                matrices are lower unitriangular, as for any such matrix
                <span class="math inline">\(A\)</span>, <span
                class="math inline">\(A_{ij} = 0\)</span> for <span
                class="math inline">\(j &gt; i\)</span> and <span
                class="math inline">\(A_{ii} = \binom{i - 1}{i - 1} =
                1\)</span>. This is also obvious from the examples.</p>
                <p>With this structure comes a few properties:</p>
                <ul>
                <li><span class="math inline">\(\det B_n =
                1\)</span>.</li>
                <li><span class="math inline">\(\det (B_n - \lambda I) =
                (\lambda - 1)^{n + 1}\)</span>.</li>
                <li><span class="math inline">\(B_n\)</span> is not
                diagonalizable.</li>
                </ul>
                <h3 id="evaluating-a-tranpose-product">Evaluating A
                Tranpose Product</h3>
                <p><strong>Question.</strong> What is <span
                class="math inline">\(B_n B_n^T\)</span>?</p>
                <p>Using Mathematica, we can gain the intuition that the
                answer should be <span class="math inline">\((B_n
                B_n^T)_{ij} = \binom{i + j - 2}{i - 1} = \binom{i + j -
                2}{j - 1}\)</span>. We can prove this is true by
                observing that <span class="math display">\[
                \begin{align*}
                    (B_n B_n^T)_{ij} &amp;= \sum_{k = 0}^{n} (B_n)_{ik}
                (B_n^T)_{kj} \\
                    &amp;= \sum_{k = 1}^{n} \binom{i - 1}{k - 1}
                \binom{j - 1}{k - 1} \\
                    &amp;= \sum_{k = 0}^{\min(i - 1, j - 1)} \binom{i -
                1}{k} \binom{j - 1}{j - 1 - k}.
                \end{align*}
                \]</span> If we WLOG let <span class="math inline">\(i
                \ge j\)</span>, then Vandermonde's identity tells us
                that <span class="math inline">\((B_n
                B_n^T)_{ij}\)</span> indeed is <span
                class="math inline">\(\binom{i + j - 2}{j -
                1}\)</span>.</p>
                <h3 id="evaluating-the-inverse">Evaluating The
                Inverse</h3>
                <p><strong>Question.</strong> What is the inverse of
                <span class="math inline">\(B_n\)</span>?</p>
                <p>Since <span class="math inline">\(B_n\)</span> is
                unitriangular, it's very easy to work out some small
                examples, so let us do so. For <span
                class="math inline">\(B_3\)</span>, we have <span
                class="math display">\[
                \begin{align*}
                    \begin{bmatrix}
                        1 &amp; 0 &amp; 0 &amp; 0 &amp; \bigm| &amp; b_1
                \\
                        1 &amp; 1 &amp; 0 &amp; 0 &amp; \bigm| &amp; b_2
                \\
                        1 &amp; 2 &amp; 1 &amp; 0 &amp; \bigm| &amp; b_3
                \\
                        1 &amp; 3 &amp; 3 &amp; 1 &amp; \bigm| &amp; b_4
                    \end{bmatrix} &amp;\longrightarrow
                    \begin{bmatrix}
                        1 &amp; 0 &amp; 0 &amp; 0 &amp; \bigm| &amp; b_1
                \\
                        0 &amp; 1 &amp; 0 &amp; 0 &amp; \bigm| &amp; b_2
                - b_1 \\
                        1 &amp; 2 &amp; 1 &amp; 0 &amp; \bigm| &amp; b_3
                \\
                        1 &amp; 3 &amp; 3 &amp; 1 &amp; \bigm| &amp; b_4
                    \end{bmatrix} \\
                    &amp;\longrightarrow
                    \begin{bmatrix}
                        1 &amp; 0 &amp; 0 &amp; 0 &amp; \bigm| &amp; b_1
                \\
                        0 &amp; 1 &amp; 0 &amp; 0 &amp; \bigm| &amp; b_2
                - b_1 \\
                        0 &amp; 0 &amp; 1 &amp; 0 &amp; \bigm| &amp; b_3
                - 2b_2 + b_1 \\
                        1 &amp; 3 &amp; 3 &amp; 1 &amp; \bigm| &amp; b_4
                    \end{bmatrix} \\
                    &amp;\longrightarrow
                    \begin{bmatrix}
                        1 &amp; 0 &amp; 0 &amp; 0 &amp; \bigm| &amp; b_1
                \\
                        0 &amp; 1 &amp; 0 &amp; 0 &amp; \bigm| &amp; b_2
                - b_1 \\
                        0 &amp; 0 &amp; 1 &amp; 0 &amp; \bigm| &amp; b_3
                - 2b_2 + b_1 \\
                        0 &amp; 0 &amp; 0 &amp; 1 &amp; \bigm| &amp; b_4
                - 3b_3 + 3b_2 - b_1
                    \end{bmatrix},
                \end{align*}
                \]</span> which I suppose is somewhat obvious. This
                tells us that <span class="math display">\[
                    B_3^{-1} = \begin{bmatrix}
                        1 &amp; 0 &amp; 0 &amp; 0 \\
                        -1 &amp; 1 &amp; 0 &amp; 0 \\
                        1 &amp; -2 &amp; 1 &amp; 0 \\
                        -1 &amp; 3 &amp; -3 &amp; 1
                    \end{bmatrix}
                ,\]</span> which allows one to guess that <span
                class="math inline">\((B_n^{-1})_{ij} = (-1)^{i + j}
                (B_n)_{ij} = (-1)^{i + j} \binom{i - 1}{j - 1}\)</span>.
                Let's try and prove this. We have that <span
                class="math display">\[
                    (B_n B_n^{-1})_{ij} = \delta_{ij}
                ,\]</span> so we must have that (credits to this <a
                href="https://artofproblemsolving.com/community/c7h1973655p13689198">aops
                thread</a> for the idea) <span class="math display">\[
                \begin{align*}
                    (B_n B_n^{-1})_{ij} &amp;= \sum_{k = 1}^{n+1}
                (B_n)_{ik} (B_n^{-1})_{kj} \\
                    &amp;= \sum_{k = 1}^{n + 1} (-1)^{k + j} \binom{i -
                1}{k - 1} \binom{k - 1}{j - 1} \\
                    &amp;= \sum_{k = 0}^{n} (-1)^{k + 1 + j} \binom{i -
                1}{k} \binom{k}{j - 1}  \\
                    &amp;= \binom{i - 1}{j - 1} (-1)^{1 + j} \sum_{k =
                0}^{n} (-1)^k \binom{i - 1 - (j - 1)}{k - (j - 1)}.
                \end{align*}
                \]</span> For <span class="math inline">\(j &gt;
                i\)</span>, this is trivially <span
                class="math inline">\(0\)</span>, so we'll assume from
                now on that <span class="math inline">\(j \le
                i\)</span>. <span class="math display">\[
                \begin{align*}
                    (B_n B_n^{-1})_{ij}  &amp;= \binom{i - 1}{j - 1}
                (-1)^{1 + j} \sum_{k = j - 1}^{i - 1} (-1)^k \binom{i -
                1 - (j - 1)}{k - (j - 1)} \\
                    &amp;= \binom{i - 1}{j - 1} (-1)^{1 + j} \sum_{k =
                0}^{i - j} (-1)^{k + j - 1} \binom{i - j}{k} \\
                    &amp;= \binom{i - 1}{j - 1} \sum_{k = 0}^{i - j}
                (-1)^k \binom{i - j}{k} \\
                    &amp;= \binom{i - 1}{j - 1} (1 - 1)^{i - j},
                \end{align*}
                \]</span> which is <span
                class="math inline">\(0\)</span> for <span
                class="math inline">\(j &lt; i\)</span> and <span
                class="math inline">\(1\)</span> only for <span
                class="math inline">\(j = i\)</span>, which is what we
                wished to show.</p>
                <h2 id="applications">Applications</h2>
                <p>Knowing the inverse actually allows one to calculate
                a formula for the number of derangements of <span
                class="math inline">\(n\)</span> objects without using
                the inclusion-exclusion principle, denoted by <span
                class="math inline">\(D_n\)</span>. In particular, we
                can show combinatorially that <span
                class="math display">\[
                    \sum_{i = 0}^{k} \binom{k}{i} D_i = k!
                ,\]</span> for all <span class="math inline">\(0 \le k
                \le n\)</span>. We can turn this into a matrix equation
                and solve to realize that <span class="math display">\[
                    \begin{bmatrix}
                        D_0 \\
                        D_1 \\
                        \vdots \\
                        D_{n}
                    \end{bmatrix} =
                    B_{n}^{-1} \begin{bmatrix}
                        0! \\
                        1! \\
                        \vdots \\
                        n!
                    \end{bmatrix}
                ,\]</span> which shows that <span
                class="math display">\[
                \begin{align*}
                    D_n &amp;= \sum_{k = 0}^{n} (-1)^k \binom{n}{n - k}
                (n-k)! \\
                    &amp;= \sum_{k = 0}^{n} (-1)^k \frac{n!}{k!} \\
                    &amp;= n! \sum_{k = 0}^{n} \frac{(-1)^k}{k!}.
                \end{align*}
                \]</span></p>
            </div>
        </div>
    </body>
</html>
